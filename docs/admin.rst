.. _picbed-admin:

===========
站点管理
===========

此为管理员的控制台配置说明，在这里可以全局设置、钩子管理等，配置项含义基本
上是简单明了，根据提示即可，下面仅说明部分重点或复杂配置。

1. 系统设置
-------------

全局设置，包括网站本身、上传细节、钩子配置。

1.1 站点设置
===============

- CORS Origin

  设置允许跨域的源站（关于CORS请参考 `Mozilla官方文档 <https://developer.mozilla.org/docs/Web/HTTP/Access_control_CORS>`_ ）

  源站格式：http[s]://domain.name
  
  不同端口不同协议均属于不同源，可以用英文逗号分隔多个！

  允许使用 **\*** 表示允许所有源，此时不可以有其他内容！

  .. tip::

    LinkToken中所用的origin是此处的子集

- 注册选项

  - 开放注册：顾名思义，允许任何人注册，否则无法注册（接口拒绝、入口隐藏）

  - 注册审核：开启后，新注册用户能登录、操作一般事务，但不能上传

  - 禁止登录：禁止普通用户登录，包括LinkToken

1.2 上传设置
==============

- 上传字段

  定义通过POST表单获取图片数据的字段，默认字段是picbed，如不明白，请勿修改！

- 存储后端

  选择保存图片的扩展钩子，本地、又拍云、GitHub等，至少有一个，否则无法保存
  图片。


1.3 钩子设置
=============

此处有模板中钩子插入点，内置与第三方钩子可以通过hooksetting定义表单，
管理员进行配置。

此区域下有邮件服务配置相关功能，除发件人名称外，其他配置项是内置的钩子 **sendmail** 提供的。

sendmail提供三种邮件发送方式：本地、诏预开放平台（自用）、SendCloud

- 本地

  即通过本机25端口邮件服务发送，不过目前云厂商基本会禁用此功能，除此之外，本机即便能发送成功，也有可能被目标邮箱服务器丢弃或放入垃圾邮件，所以很多情况下，可以直接不使用跳过它。

- SendCloud

  SendCloud由搜狐武汉研发中心孵化的项目，是致力于为开发者提供高质量的触发邮件服务的云端邮件发送平台，为开发者提供便利的API接口来调用服务。

  官网: https://sendcloud.sohu.com

  登录进去，有系统默认发信邮箱，也可以添加自有发信域，详情参考其官方文档。

  这里需要提供一个API_USER及对应的API_KEY，还一个可选的发件人（最近发件人邮箱后缀是API_USER对应的发信域）

ps：后续会独立一个第三方邮件发送钩子，添加QQ、163、自有域名邮箱等。

2. 钩子扩展
---------------

2.1 安装第三方包
===================

调用pip命令，安装pypi上的包，或者直接安装诸如git、svn上的模块。

注意，此功能仅仅是安装（到用户家目录下），并不会加载到程序中。

2.2 添加第三方钩子
=====================

将第三方包加载到程序中，作为钩子扩展功能点。

3. 用户管理
-------------

- 设置、取消管理员（不能对自己使用）

- 审核新用户

- 禁用用户：不允许登录、上传等一切操作

- 删除用户

- 验证过邮箱的用户邮箱字段是绿色的。
